#!/bin/bash

# Vérifiez si un argument a été fourni
if [ "$#" -ne 1 ]; then
    echo "Usage: $0 <snapshot_file_name>"
    exit 1
fi

# Assignez l'argument fourni à une variable
SNAPSHOT_FILE_NAME=$1

# Utilisez la variable dans la commande
ETCDCTL_API=3 etcdctl --data-dir="/var/lib/etcd/" \
--endpoints=https://{{ inventory_hostname }}:2379 \
--cacert=/etc/kubernetes/pki/etcd/ca.crt \
--cert=/etc/kubernetes/pki/etcd/server.crt \
--key=/etc/kubernetes/pki/etcd/server.key \
snapshot restore $SNAPSHOT_FILE_NAME